<%- include('../functions.ejs') %>

<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head.ejs') %>
</head>

<body>
    <%- include('./partials/profiles/nav_bar.ejs') %>


    <div class="container vert-gap-container">
        <div class="row">
            <h2 class="vert-gap-contents">User Information <%= hardcode_email %></h2>
        </div>
        <div class="row">
            <h4 class="vert-gap-contents">Pet Information</h4>
        </div>
        <div class="row text-left">
            <% my_pets.forEach(pet => { %>
                <div class="card col-sm col-md" id="square-card">
                    <p><b>Pet Name:</b> <%= pet.pet_name %><br>
                       <b>Special Requirements:</b> <%= pet.special_requirement %><br>
                    </p>
                </div>
            <% }) %>
        </div>
    </div>

    <div class="container vert-gap-container">
        <div class="row">
            <h2 class="vert-gap-contents">Top Caretakers Nearby</h2>
            <a href="/search" style="padding: 13px">See more</a> <!-- link this to search for nearby caretakers-->
        </div>
        <div class="row text-left">
            <% top_ratings.forEach(caretaker => { %>
                <div class="card col-sm col-md" id="square-card">
                    <p><b>Name:</b> <%= caretaker.name %><br>
                        <b>Rating:</b> <%= caretaker.rating == null ? "No Rating Yet" : caretaker.rating %><br>
                        <b>Location:</b> <%= caretaker.location %><br>
                        <b>Job:</b> <%= caretaker.job == "part_timer" ? "Part Time" : "Full Time" %><br>
                    </p>
                </div>
            <% }) %>
        </div>
        
    </div>
    
    <div class="container vert-gap-container">
        <div class="row">
            <h2 class="vert-gap-contents">Ongoing Transactions</h2>
            <a href="/ongoing_transactions" style="padding: 13px">See more</a>
        </div>
        <div class="row text-left">
            <% ongoing_transactions.forEach(ongoing => { %>
                <div class="card col-sm col-md" id="square-card">
                    <p><b>Status</b> <%= ongoing.hire_status %><br>
                       <b>Date:</b> <%= stringToDate(String(ongoing.start_date)) %> to <%= stringToDate(String(ongoing.end_date)) %><br>
                       <b>Caretaker:</b> <%= ongoing.ct_name %><br>
                       <b>User:</b> <%= ongoing.po_name %><br>
                       <b>Pet Name:</b> <%= ongoing.pet_name %><br>
                    </p>
                </div>
            <% }) %>
        </div>        
    </div>

    <div class="container vert-gap-container vert-gap-contents">
        <div class="row">
            <h2 class="vert-gap-contents">Recent Transactions</h2>
            <a href="/transactions" style="padding: 13px">See more</a>
        </div>
        <div class="row text-left">
            <% completed_transactions.forEach(completed => { %>
                <div class="card col-sm col-md" id="square-card">
                    <p><b>Status:</b> <%= completed.hire_status %><br>
                    <b>Date:</b> <%= stringToDate(String(completed.start_date)) %> to <%= stringToDate(String(completed.end_date)) %><br>
                    <b>Caretaker:</b> <%= completed.ct_name %><br>
                    <b>User:</b> <%= completed.po_name %><br>
                    <b>Pet Name:</b> <%= completed.pet_name %><br>
                    <b>Rating:</b> <%= completed.rating == null ? "No Rating Yet" : completed.rating %><br>
                    <b>Review:</b> <%= completed.review_text == null ? "No Review Yet" : completed.review_text %><br>
                    </p>
                </div>
            <% }) %>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>

</html>